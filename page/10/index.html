<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Page 10 | ac黄的博客 | acwong&#39;s blog</title>

  
  <meta name="author" content="acwong">
  

  
  <meta name="description" content="ac黄的博客">
  

  

  <meta id="viewport" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  

  <meta property="og:site_name" content="ac黄的博客"/>

  
  <meta property="og:image" content="/favicon.ico"/>
  

  <link href="/favicon.ico" rel="icon">
  <link rel="alternate" href="/atom.xml" title="ac黄的博客" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
<meta name="generator" content="Hexo 5.4.2"></head>


<body>
<div class="blog">
  <div class="content">

    <header>
  <div class="site-branding">
    <h1 class="site-title">
      <a href="/">ac黄的博客</a>
    </h1>
    <p class="site-description">acwong&#39;s blog</p>
  </div>
  <nav class="site-navigation">
    <ul>
      
        <li><a href="/">Home</a></li>
        
      
        <li><a href="/archives">Archives</a></li>
        
      
        <li><a href="/tags">Tags</a></li>
        
      
        <li><a href="/categories">Categories</a></li>
        
      
        
        <li><a href="mailto:acwong@yeah.net">Email</a></li>
      
    </ul>
  </nav>
</header>

    <main class="site-main posts-loop">
    
  <article>

  
    
    <h3 class="article-title"><a href="/2014/11/15/2048-with-seajs/"><span>Seajs 实践(一)—— 模块化 2048 游戏</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2014/11/15/2048-with-seajs/" rel="bookmark">
        <time class="entry-date published" datetime="2014-11-15T15:43:42.000Z">
          2014-11-15
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>前段时间在<a target="_blank" rel="noopener" href="http://www.imooc.com/">慕课网</a>跟着视频做了一个简单的 2048 游戏，发现这个小项目非常适合用来实践 Seajs 模块化，现在就把我的实践过程和大家分享一下。</p>
<h2 id="实践过程"><a href="#实践过程" class="headerlink" title="实践过程"></a>实践过程</h2><h3 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h3><p>没有进行模块化之前总共有5个文件：</p>
<ul>
<li><strong>index.html</strong>        游戏页面</li>
<li><strong>2048.css</strong>          游戏样式文件</li>
<li><strong>main.js</strong>           程序入口文件</li>
<li><strong>showanimation.js</strong>  游戏动画文件</li>
<li><strong>support.js</strong>        基础函数文件</li>
</ul>
<p><em>main.js</em> 需要使用 <em>showanimation.js</em> 和 <em>support.js</em> 定义的函数。</p>
<p><em>showanimation.js</em> 需要使用 <em>support.js</em> 定义的函数。</p>
<p>除了这些文件之外，这个项目还用了jQuery的库，用了<a target="_blank" rel="noopener" href="http://apps.bdimg.com/libs/jquery/2.1.1/jquery.min.js">百度的cdn</a>。</p>
<p>目前 js 文件引入顺序如下:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://apps.bdimg.com/libs/jquery/2.1.1/jquery.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;../static/game/support.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;../static/game/showanimation.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;../static/game/main.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h3><p><a target="_blank" rel="noopener" href="https://acwong-blog.oss-cn-shenzhen.aliyuncs.com/2048-folder-structure.PNG"><img src="https://acwong-blog.oss-cn-shenzhen.aliyuncs.com/2048-folder-structure.PNG" alt="2048文件目录结构"></a></p>
<p>源文件可以在<a target="_blank" rel="noopener" href="https://github.com/acwong00/blog-demo-code/tree/master/seajs-2048/2048">这里</a>找到，有兴趣的朋友可以下载下来尝试一下。</p>
<h3 id="引入Sea-js"><a href="#引入Sea-js" class="headerlink" title="引入Sea.js"></a>引入Sea.js</h3><p>在<a target="_blank" rel="noopener" href="http://seajs.org/docs/#downloads">Seajs官网</a>下载Sea.js(本文用到的版本是 2.3.0)。在<em>static</em>目录下建立一个<em>lib</em>文件夹，存放下载下来的<em>sea.js</em>。</p>
<p>然后引入：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;../static/lib/sea.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="CMD规范改写"><a href="#CMD规范改写" class="headerlink" title="CMD规范改写"></a>CMD规范改写</h3><p>CMD ( Common Module Definition ) 是Seajs遵循的一种模块定义规范。规范当中，一个模块就是一个文件，因此我按照CMD规范改写 2048 游戏的3个 js 文件。</p>
<blockquote>
<p>SeaJS 里，推崇的 Modules/Wrappings 规范是 CMD 规范：<code>define(function()&#123; &#125;)</code> 直接是由开发者手写的，写完后，可直接不经过任何构建工具就在浏览器上加载运行。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">define</span>(<span class="keyword">function</span>(<span class="params"><span class="built_in">require</span>, <span class="built_in">exports</span>, <span class="variable language_">module</span></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="built_in">require</span>(<span class="string">&quot;a&quot;</span>)</span><br><span class="line">    <span class="built_in">exports</span>.<span class="property">foo</span> = ...</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>首先，<em>main.js</em>、<em>showanimation.js</em> 和 <em>support.js</em> 三个文件都用 <code>defined</code> 函数包裹起来，<code>define</code> 接收一个匿名函数作为参数，该函数传入默认的三个参数  <code>require</code>、<code>exports</code> 和 <code>moudule</code> 。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">define</span>(<span class="keyword">function</span>(<span class="params"><span class="built_in">require</span>, <span class="built_in">exports</span>, moudule</span>)&#123;</span><br><span class="line">	<span class="comment">// support.js 代码</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">define</span>(<span class="keyword">function</span>(<span class="params"><span class="built_in">require</span>, <span class="built_in">exports</span>, moudule</span>)&#123;</span><br><span class="line">	<span class="comment">// showanimation.js 代码</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">define</span>(<span class="keyword">function</span>(<span class="params"><span class="built_in">require</span>, <span class="built_in">exports</span>, moudule</span>)&#123;</span><br><span class="line">	<span class="comment">// main.js 代码</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>接着，把 <em>showanimation.js</em> 和 <em>support.js</em> 当中需要被其他模块调用的函数和变量使用 <code>exports</code> 暴露给其他模块。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 暴露变量</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">documentWidth</span> = documentWidth;</span><br><span class="line"><span class="built_in">exports</span>.<span class="property">gridContainerWidth</span> = gridContainerWidth;</span><br><span class="line"><span class="built_in">exports</span>.<span class="property">cellSideLength</span> = cellSideLength;</span><br><span class="line"><span class="built_in">exports</span>.<span class="property">cellSpace</span> = cellSpace;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 暴露函数</span></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">getPostTop</span> = <span class="keyword">function</span>(<span class="params">i,j</span>) &#123;</span><br><span class="line">    <span class="comment">// code</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">exports</span>.<span class="property">getPostLeft</span> = <span class="keyword">function</span>(<span class="params">i,j</span>) &#123;</span><br><span class="line">    <span class="comment">// code</span></span><br><span class="line">&#125;;</span><br><span class="line">......</span><br></pre></td></tr></table></figure>

<p>然后，使用 <code>require</code> 来获取其他模块暴露的接口.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="keyword">var</span> support = <span class="built_in">require</span>(<span class="string">&#x27;./support&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> animation = <span class="built_in">require</span>(<span class="string">&#x27;./showanimation&#x27;</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// showanimation.js</span></span><br><span class="line"><span class="keyword">var</span> support = <span class="built_in">require</span>(<span class="string">&#x27;./support&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>最后，将原来调用其它模块的方法或变量改写为，以下形式：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="built_in">require</span>(<span class="string">&#x27;./a&#x27;</span>);</span><br><span class="line"><span class="comment">// 调用模块 a 的方法</span></span><br><span class="line">a.<span class="title function_">doSomething</span>();</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="comment">// 调用变量</span></span><br><span class="line">support.<span class="property">cellSpace</span> = <span class="number">20</span>;</span><br><span class="line">support.<span class="property">cellSideLength</span> = <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用 showanimation.js 方法</span></span><br><span class="line">animation.<span class="title function_">showNumberWithAnimation</span>(randx, randy, randNumber);</span><br><span class="line"><span class="comment">// 调用 support.js 方法</span></span><br><span class="line">support.<span class="title function_">canMoveDown</span>(board)</span><br></pre></td></tr></table></figure>

<h3 id="在页面当中加载入口模块"><a href="#在页面当中加载入口模块" class="headerlink" title="在页面当中加载入口模块"></a>在页面当中加载入口模块</h3><p>在引入 <em>sea.js</em> 之后，在该 <strong>script</strong> 标签之后，再写一段 seajs 的配置代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">seajs.<span class="title function_">config</span>(&#123;</span><br><span class="line">    <span class="attr">base</span>: <span class="string">&quot;../static&quot;</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 加载入口模块 </span></span><br><span class="line">seajs.<span class="title function_">use</span>([<span class="string">&quot;game/main&quot;</span>]);</span><br></pre></td></tr></table></figure>

<h3 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h3><p>经过上述过程之后 2048 游戏已经完成了模块化，现在打开浏览器运行一下,就可以正确运行了。</p>
<p><a target="_blank" rel="noopener" href="https://acwong-blog.oss-cn-shenzhen.aliyuncs.com/2048s-start.PNG"><img src="https://acwong-blog.oss-cn-shenzhen.aliyuncs.com/2048s-start.PNG" alt="2048运行效果"></a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/acwong00/blog-demo-code/tree/master/seajs-2048/2048-with-seajs">这里</a>是完成后的代码。</p>
<h2 id="使用Seajs的意义"><a href="#使用Seajs的意义" class="headerlink" title="使用Seajs的意义"></a>使用Seajs的意义</h2><p>使用 Seajs 将各个文件转变成一个个独立的模块，模块当中可以方便的对函数和变量进行命名，免去了多个文件之间命名冲突的烦恼。除此之外，使用 Seajs 还可以在 js 文件当中声明所需的依赖，不再需要手动在引入过程中管理，降低了开发时出错的几率。</p>
<p>在 EMCAScript6 <code>import</code> 功能出现之前，Seajs 的确是一个不错的前端模块化工具。</p>
<p><a target="_blank" rel="noopener" href="http://blog.acwong.org/2014/11/16/2048-with-seajs-and-spm3/">下一篇文章</a>，我会谈一下如何用 spm3 进行Seajs标准构建。</p>
<p>感谢您的阅读，有不足之处请为我指出。</p>
<p><strong>参考</strong></p>
<ol>
<li><a target="_blank" rel="noopener" href="https://github.com/seajs/seajs/issues/242">CMD 模块定义规范</a></li>
<li><a target="_blank" rel="noopener" href="http://www.zhihu.com/question/20789867/answer/16187950">CommonJS 的 Modules/Transport 和 Modules/Wrappings 规范有什么区别？ – 知乎</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/seajs/seajs/issues/547">前端模块化开发的价值</a></li>
</ol>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/技术实践/">技术实践</a>
    </span>
    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/前端模块化/">前端模块化</a><a href="/tags/seajs/">seajs</a>
    </span>
    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2014/11/08/drag-and-drop/"><span>不在HTML5标准中的特性 —— 浅谈原生拖放</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2014/11/08/drag-and-drop/" rel="bookmark">
        <time class="entry-date published" datetime="2014-11-08T06:54:36.000Z">
          2014-11-08
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <h2 id="久等的HTML5标准"><a href="#久等的HTML5标准" class="headerlink" title="久等的HTML5标准"></a>久等的HTML5标准</h2><p>2014年10月28日，W3C正式公布了耗时8年时间制订的 HTML5 标准。尽管标准在最近才正式公布，但 HTML5 激动人心的特性一早就被开发者热议了。在这份标准当中有一个我们熟悉的身影并没有出现，那就是原生拖放 —— Drag and Drop。</p>
<blockquote>
<p>10月28日发布的<a target="_blank" rel="noopener" href="http://www.w3.org/TR/html5/">HTML5版本</a>当中没有原生拖放。</p>
</blockquote>
<blockquote>
<p>而制订当中的<a target="_blank" rel="noopener" href="http://www.w3.org/html/wg/drafts/html/master/editing.html#dnd">HTML5.1版本</a>当中则可以看到。</p>
</blockquote>
<p>没有人知道HTML5标准为什么没有了原生拖放特性，我想可能与其设计上的缺陷有关，在谈这个问题之前，先简单介绍一下原生拖放的特性。</p>
<h2 id="Drag-and-Drop-简介"><a href="#Drag-and-Drop-简介" class="headerlink" title="Drag and Drop 简介"></a>Drag and Drop 简介</h2><h3 id="可拖动属性"><a href="#可拖动属性" class="headerlink" title="可拖动属性"></a>可拖动属性</h3><p>图像、链接和文本是浏览器默认可以被拖动的，HTML5 为所有的HTML元素都提供了一个<strong>draggable</strong>属性，当这个属性的值为<strong>true</strong>的时候，元素被视为可以拖动。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 禁止元素被拖动 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;不能拖动我&quot;</span> <span class="attr">draggable</span>=<span class="string">&quot;true&quot;</span>&gt;</span>不能拖动我<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 让元素可以被拖动 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">draggable</span>=<span class="string">&quot;false&quot;</span>&gt;</span>可以被拖动<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="拖放事件"><a href="#拖放事件" class="headerlink" title="拖放事件"></a>拖放事件</h3><p>利用拖放事件，我们可以控制拖放过程中的各个阶段。</p>
<p>对于被拖放的元素包括下列事件：</p>
<ul>
<li>dragstart <em>鼠标点击被拖动元素开始拖动时在该元素触发</em>       </li>
<li>drag <em>拖动元素时频繁在被拖动元素触发</em></li>
<li>dragend <em>拖动停止并放置之后触发</em></li>
</ul>
<p>对于目标放置元素包括下列事件</p>
<ul>
<li>dragenter <em>元素被拖动时鼠标进入目标放置元素时触发</em></li>
<li>dragover <em>元素被拖动时鼠标在目标放置元素时频繁触发</em></li>
<li>dragleave <em>元素被拖动时鼠标离开目标放置元素时触发</em></li>
<li>drop <em>元素被拖动到目标放置元素并放开鼠标进行放置时触发</em></li>
</ul>
<p>可以看出，拖放特性的核心就是拖动一个元素放置到一个目标元素当中。</p>
<h3 id="dataTransfer"><a href="#dataTransfer" class="headerlink" title="dataTransfer"></a>dataTransfer</h3><p>我认为原生拖放当中最令人兴奋的特性就是可以利用拖放事件传递数据，这样使浏览器原生就可以支持类似于桌面应用的拖放交互功能。</p>
<p>要使用数据传输功能就需要一个名为 dataTransfer 的接口。</p>
<p>dataTransfer 主要包括 getData() 和 setData() 方法。 setData() 用于保存值，getData() 用于获得 setData() 保存的值。</p>
<blockquote>
<p>dataTransfer.setData(format, data)</p>
</blockquote>
<blockquote>
<p>dataTransfer.getData(format)</p>
</blockquote>
<p>format 参数支持MIME数据类型。</p>
<p>一个小例子 <a target="_blank" rel="noopener" href="http://jsfiddle.net/acwong/00p1mppp/2/embedded/result/">传送门</a>。</p>
<h3 id="dropEffect-和-effectAllowed"><a href="#dropEffect-和-effectAllowed" class="headerlink" title="dropEffect 和 effectAllowed"></a>dropEffect 和 effectAllowed</h3><p>dataTransfer 接口还有两个有趣的属性。</p>
<p><strong>dropEffect</strong> 浏览器会根据不同的值显示不同类型的光标，提升用户放置后的行为。 dropEffect 包括以下几个值:</p>
<ul>
<li>none <em>不能把拖动的元素放置在这里</em></li>
<li>move <em>把元素移动到这里</em></li>
<li>copy <em>把元素复制到这里</em></li>
<li>link <em>放置到这里后打开链接</em></li>
</ul>
<p>浏览器仅仅会帮你改变光标的类型，但是要实现怎样的效果都是要开发者自己去实现。</p>
<p><strong>effectAllowed</strong> 搭配 dropEffect 使用，表示允许dropEffect的哪种行为，它的值有以下几种：</p>
<ul>
<li>none <em>被拖动元素不能有任何行为</em></li>
<li>copy <em>允许值为 “copy” 的放置行为</em></li>
<li>link <em>允许值为 “link” 的放置行为</em></li>
<li>move <em>允许值为 “move” 的放置行为</em></li>
<li>copyLink <em>允许值为 “copy” 和 “link” 的放置行为</em></li>
<li>copyMove <em>允许值为 “copy” 和 “move” 的放置行为</em></li>
<li>linkMove <em>允许值为 “link” 和 “move” 的放置行为</em></li>
<li>all <em>允许所有放置行为</em></li>
</ul>
<p>便于理解请看例子 <a target="_blank" rel="noopener" href="http://help.dottoro.com/external/examples/ljffjemc/dropEffect_1.htm">传送门</a></p>
<h2 id="Drag-and-Drop-的坑"><a href="#Drag-and-Drop-的坑" class="headerlink" title="Drag and Drop 的坑"></a>Drag and Drop 的坑</h2><h3 id="Drag-and-Drop-的历史"><a href="#Drag-and-Drop-的历史" class="headerlink" title="Drag and Drop 的历史"></a>Drag and Drop 的历史</h3><p>与其他的 HTML5 特性不同，Drag and Drop 的<a target="_blank" rel="noopener" href="http://fmbip.com/litmus#html5-web-applications">浏览器兼容性</a>可以说鹤立鸡群。</p>
<p><a target="_blank" rel="noopener" href="https://acwong-blog.oss-cn-shenzhen.aliyuncs.com/dnd-compatibility.PNG"><img src="https://acwong-blog.oss-cn-shenzhen.aliyuncs.com/dnd-compatibility.PNG" alt="addEventListener"></a></p>
<p>拖放功能最早在IE4时候就被引入，而在目前的拖放模型则是基于IE5.5的模型建立的。由于这个原因导致了原生拖放当中出现了各种不同的坑。</p>
<h3 id="我开发中遇到的问题"><a href="#我开发中遇到的问题" class="headerlink" title="我开发中遇到的问题"></a>我开发中遇到的问题</h3><p>前阵子做了一个360度全景效果的demo，一开始想到用drag事件来做。</p>
<p>首先准备图片:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;panorama&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;images/0.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;images/1.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;images/2.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">        .......</span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;images/74.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;images/75.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;images/76.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>然后利用 drag 事件频繁发生，在 drag 事件触发时，判断鼠标位移，然后显示下一张图片，利用人的视觉残留，做出360度全景图片的效果。(使用了 jQuery 库)</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> panorama = $(<span class="string">&#x27;#panorama&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> images = panorama.<span class="title function_">find</span>(<span class="string">&#x27;img&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> len = images.<span class="property">length</span>;</span><br><span class="line"><span class="keyword">var</span> start_X = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">var</span> start_Y = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">panorama.<span class="title function_">on</span>(<span class="string">&#x27;dragstart&#x27;</span>, <span class="keyword">function</span>(<span class="params">event</span>) &#123;</span><br><span class="line">	start_X = event.<span class="property">originalEvent</span>.<span class="property">x</span>;</span><br><span class="line">	start_Y = event.<span class="property">originalEvent</span>.<span class="property">y</span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">panorama.<span class="title function_">on</span>(<span class="string">&#x27;drag&#x27;</span>, <span class="keyword">function</span>(<span class="params">event</span>) &#123;</span><br><span class="line">	<span class="keyword">var</span> mouse_X = event.<span class="property">originalEvent</span>.<span class="property">x</span>;</span><br><span class="line">	<span class="keyword">var</span> mouse_Y = event.<span class="property">originalEvent</span>.<span class="property">y</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (mouse_X - start_X &gt; <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="title function_">moveImg</span>(<span class="string">&#x27;right&#x27;</span>);</span><br><span class="line">		start_X = mouse_X;</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> (start_X - mouse_X &gt; <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="title function_">moveImg</span>(<span class="string">&#x27;left&#x27;</span>);</span><br><span class="line">		start_X = mouse_X;</span><br><span class="line">	&#125;		</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">moveImg</span>(<span class="params">dir</span>) &#123;</span><br><span class="line">	<span class="keyword">var</span> current_img = panorama.<span class="title function_">find</span>(<span class="string">&#x27;img:visible&#x27;</span>);</span><br><span class="line">	<span class="keyword">var</span> index = current_img.<span class="title function_">index</span>();</span><br><span class="line">	<span class="keyword">if</span> (dir === <span class="string">&#x27;right&#x27;</span>) &#123;</span><br><span class="line">		<span class="keyword">if</span> (index + <span class="number">1</span> === len) &#123;</span><br><span class="line">			images.<span class="title function_">eq</span>(<span class="number">0</span>).<span class="title function_">show</span>().<span class="title function_">siblings</span>().<span class="title function_">hide</span>();</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			images.<span class="title function_">eq</span>(index + <span class="number">1</span>).<span class="title function_">show</span>().<span class="title function_">siblings</span>().<span class="title function_">hide</span>();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> (index - <span class="number">1</span> === <span class="number">0</span>) &#123;</span><br><span class="line">			images.<span class="title function_">eq</span>(len - <span class="number">1</span>).<span class="title function_">show</span>().<span class="title function_">siblings</span>().<span class="title function_">hide</span>();</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			images.<span class="title function_">eq</span>(index - <span class="number">1</span>).<span class="title function_">show</span>().<span class="title function_">siblings</span>().<span class="title function_">hide</span>();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong><a target="_blank" rel="noopener" href="http://jsfiddle.net/acwong/xpk5932b/">demo</a></strong></p>
<p>完成demo之后发现，浏览器对图片有默认的拖动效果。</p>
<p><a target="_blank" rel="noopener" href="https://acwong-blog.oss-cn-shenzhen.aliyuncs.com/drag360.PNG"><img src="https://acwong-blog.oss-cn-shenzhen.aliyuncs.com/drag360.PNG" alt="图片默认拖动效果"></a></p>
<p>要去掉这个效果可以在 dragstart 或 mousedown 事件中调用 event.preventDefault() 方法。但是无论使用上述哪一种方法都会导致 drag 事件失效。找了很多资料也没有找到很好的解决方法。所以最后我还是老老实实地用了 mouse 事件的方法重写了一遍。</p>
<p><strong><a target="_blank" rel="noopener" href="http://jsfiddle.net/acwong/xpk5932b/1/">demo</a></strong></p>
<h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><p>除了图片默认拖动效果的小问题之外，在网络上也有许多使用 drag and drop 的吐槽，像<a target="_blank" rel="noopener" href="https://ghsky.com/2012/09/talk-about-html5-drag-and-drop.html">这一篇</a>说出了很多拖放特性相关事件在使用上的很多坑。</p>
<p>当然还有PPK对拖放特性的<a target="_blank" rel="noopener" href="http://www.quirksmode.org/blog/archives/2009/09/the_html5_drag.html">吐槽</a>。09年的时候PPK就说应该把拖放特性在 HTML5 里面删除。</p>
<blockquote>
<p>The module should be removed from the HTML5 specification straight away, and conforming browsers should disable it at their earliest opportunity pending a complete rewrite from the ground up.</p>
</blockquote>
<h2 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h2><p>原生拖放的设计的确是极大地提高了浏览器与用户的交互性，但是基于 IE5.5 设计的 HTML5 原生拖放却并不是十分好用，使用过程中总会遇到一些麻烦，而且我认为 dropEffect 和 effectAllowed 略显鸡肋并且难以理解。我想这些都是 HTML5 暂时没有这个特性的原因。</p>
<p>希望后续的版本原生拖放成为一个让人眼前一亮的功能。</p>
<p>感谢您的阅读，有不足之处请在评论为我指出。</p>
<p><strong>参考</strong></p>
<ol>
<li><a target="_blank" rel="noopener" href="http://help.dottoro.com/ljffjemc.php">dropEffect property (dataTransfer)</a></li>
<li><a target="_blank" rel="noopener" href="http://book.douban.com/subject/10546125/">JavaScript高级程序设计(第3版)</a></li>
<li><a target="_blank" rel="noopener" href="https://ghsky.com/2012/09/talk-about-html5-drag-and-drop.html">浅谈 HTML5 的 Drag and Drop</a></li>
<li><a target="_blank" rel="noopener" href="http://www.quirksmode.org/blog/archives/2009/09/the_html5_drag.html">The HTML5 drag and drop disaster</a></li>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/19036977/why-is-event-preventdefault-in-dragstart-interrupting-furthur-drag-events-from?nsukey=nAJoypRJ/Y1BrOvXfa1fWU2dcz2tJ4S0mv0B4f5G0a+6zdcX0XO6q9QGbfadlJ1eeYaogaKSDjRa4xL4wzNLIQ==">Why is event.preventDefault() in dragstart interrupting furthur drag events from executing? – stackoverflow</a></li>
</ol>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/技术研究/">技术研究</a>
    </span>
    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/事件/">事件</a><a href="/tags/HTML5/">HTML5</a><a href="/tags/原生拖放/">原生拖放</a><a href="/tags/Drag-and-Drop/">Drag and Drop</a>
    </span>
    

    </div>

    
  </div>
</article>



  <article>

  
    
    <h3 class="article-title"><a href="/2014/10/28/bubbling-and-capturing/"><span>浅谈事件冒泡与事件捕获</span></a></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2014/10/28/bubbling-and-capturing/" rel="bookmark">
        <time class="entry-date published" datetime="2014-10-28T13:38:24.000Z">
          2014-10-28
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <h2 id="事件冒泡与事件捕获"><a href="#事件冒泡与事件捕获" class="headerlink" title="事件冒泡与事件捕获"></a>事件冒泡与事件捕获</h2><p>事件冒泡和事件捕获分别由微软和网景公司提出，这两个概念都是为了解决页面中<strong>事件流</strong>（事件发生顺序）的问题。</p>
<figure class="highlight html"><figcaption><span>HTML</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;outer&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">&quot;inner&quot;</span>&gt;</span>Click me!<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>上面的代码当中一个div元素当中有一个p子元素，如果两个元素都有一个click的处理函数，那么我们怎么才能知道哪一个函数会首先被触发呢？</p>
<p>为了解决这个问题微软和网景提出了两种几乎完全相反的概念。</p>
<h3 id="事件冒泡"><a href="#事件冒泡" class="headerlink" title="事件冒泡"></a>事件冒泡</h3><p>微软提出了名为<strong>事件冒泡</strong>(event bubbling)的事件流。事件冒泡可以形象地比喻为把一颗石头投入水中，泡泡会一直从水底冒出水面。也就是说，事件会从最内层的元素开始发生，一直向上传播，直到document对象。</p>
<p>因此上面的例子在事件冒泡的概念下发生click事件的顺序应该是<em><strong>p -&gt; div -&gt; body -&gt; html -&gt; document</strong></em></p>
<h3 id="事件捕获"><a href="#事件捕获" class="headerlink" title="事件捕获"></a>事件捕获</h3><p>网景提出另一种事件流名为<strong>事件捕获</strong>(event capturing)。与事件冒泡相反，事件会从最外层开始发生，直到最具体的元素。</p>
<p>上面的例子在事件捕获的概念下发生click事件的顺序应该是<em><strong>document -&gt; html -&gt; body -&gt; div -&gt; p</strong></em></p>
<h2 id="addEventListener的第三个参数"><a href="#addEventListener的第三个参数" class="headerlink" title="addEventListener的第三个参数"></a>addEventListener的第三个参数</h2><p>“DOM2级事件”中规定的事件流同时支持了事件捕获阶段和事件冒泡阶段，而作为开发者，我们可以选择事件处理函数在哪一个阶段被调用。</p>
<p>addEventListener方法用来为一个特定的元素绑定一个事件处理函数，是JavaScript中的常用方法。addEventListener有三个参数：</p>
<blockquote>
<p>element.addEventListener(event, function, useCapture)</p>
</blockquote>
<p>第一个参数是需要绑定的事件，第二个参数是触发事件后要执行的函数。而第三个参数默认值是false，表示在事件冒泡的阶段调用事件处理函数，如果参数为true，则表示在事件捕获阶段调用处理函数。请看<a target="_blank" rel="noopener" href="http://www.w3schools.com/jsref/tryit.asp?filename=tryjsref_element_addeventlistener_capture">例子</a>。</p>
<h2 id="事件代理"><a href="#事件代理" class="headerlink" title="事件代理"></a>事件代理</h2><p>在实际的开发当中，利用事件流的特性，我们可以使用一种叫做事件代理的方法。</p>
<figure class="highlight html"><figcaption><span>HTML</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">&quot;color-list&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>red<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>yellow<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>blue<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>green<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>black<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>white<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>如果点击页面中的li元素，然后输出li当中的颜色，我们通常会这样写:</p>
<figure class="highlight javascript"><figcaption><span>JavaScript</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> color_list = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;color-list&#x27;</span>);</span><br><span class="line">    <span class="keyword">var</span> colors = color_list.<span class="title function_">getElementsByTagName</span>(<span class="string">&#x27;li&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;colors.<span class="property">length</span>;i++)&#123;</span><br><span class="line">        colors[i].<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>,showColor,<span class="literal">false</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">showColor</span>(<span class="params">e</span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> x = e.<span class="property">target</span>;</span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&quot;The color is &quot;</span> + x.<span class="property">innerHTML</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>

<p>利用事件流的特性，我们只绑定一个事件处理函数也可以完成：</p>
<figure class="highlight javascript"><figcaption><span>JavaScript</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> color_list = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;color-list&#x27;</span>);</span><br><span class="line">    color_list.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>,showColor,<span class="literal">false</span>);</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">showColor</span>(<span class="params">e</span>)&#123;</span><br><span class="line">        <span class="keyword">var</span> x = e.<span class="property">target</span>;</span><br><span class="line">        <span class="keyword">if</span>(x.<span class="property">nodeName</span>.<span class="title function_">toLowerCase</span>() === <span class="string">&#x27;li&#x27;</span>)&#123;</span><br><span class="line">            <span class="title function_">alert</span>(<span class="string">&#x27;The color is &#x27;</span> + x.<span class="property">innerHTML</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>

<p>使用事件代理的好处不仅在于将多个事件处理函数减为一个，而且对于不同的元素可以有不同的处理方法。假如上述列表元素当中添加了其他的元素（如：a、span等），我们不必再一次循环给每一个元素绑定事件，直接修改事件代理的事件处理函数即可。</p>
<h3 id="冒泡还是捕获？"><a href="#冒泡还是捕获？" class="headerlink" title="冒泡还是捕获？"></a>冒泡还是捕获？</h3><p>对于事件代理来说，在事件捕获或者事件冒泡阶段处理并没有明显的优劣之分，但是由于事件冒泡的事件流模型被所有主流的浏览器兼容，从兼容性角度来说还是建议大家使用事件冒泡模型。</p>
<h3 id="IE浏览器兼容"><a href="#IE浏览器兼容" class="headerlink" title="IE浏览器兼容"></a>IE浏览器兼容</h3><p>IE浏览器对addEventListener兼容性并不算太好，只有IE9以上可以使用。</p>
<p><a target="_blank" rel="noopener" href="https://acwong-blog.oss-cn-shenzhen.aliyuncs.com/acwongblogaddEventListener.PNG"><img src="https://acwong-blog.oss-cn-shenzhen.aliyuncs.com/acwongblogaddEventListener.PNG" alt="addEventListener"></a></p>
<p>要兼容旧版本的IE浏览器，可以使用IE的attachEvent函数</p>
<blockquote>
<p>object.attachEvent(event, function)</p>
</blockquote>
<p>两个参数与addEventListener相似，分别是事件和处理函数，默认是事件冒泡阶段调用处理函数，要注意的是，写事件名时候要加上”on”前缀（”onload”、”onclick”等）。</p>
<p>感谢您的阅读，有不足之处请在评论为我指出。</p>
<p><strong>参考</strong></p>
<ol>
<li><a target="_blank" rel="noopener" href="http://www.w3schools.com/jsref/met_element_addeventlistener.asp">HTML DOM addEventListener() Method – w3schools</a></li>
<li><a target="_blank" rel="noopener" href="http://book.douban.com/subject/10546125/">JavaScript高级程序设计(第3版)</a></li>
<li><a target="_blank" rel="noopener" href="http://msdn.microsoft.com/en-us/library/ie/ms536343.aspx">attachEvent method – MSDN</a></li>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/4616694/what-is-event-bubbling-and-capturing?nsukey=zA51Jl1Abrk/RkPZVPbCjx4J80CbKY93tVZAAejv4ySodF5MTEOdxPCiy4RFfLE5hPcgmYVt2Y4ma7A5hHfbXg==">What is event bubbling and capturing – Stack Overflow</a></li>
</ol>

      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    
      

    <span class="post-categories">
      <i class="icon-categories"></i>
        <a href="/categories/技术研究/">技术研究</a>
    </span>
    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/JavaScript/">JavaScript</a><a href="/tags/事件/">事件</a>
    </span>
    

    </div>

    
  </div>
</article>




<nav class="pagination">
  
  <a href="/page/9/" class="pagination-prev">Prev</a>
  
  
</nav>
    </main>

    <footer class="site-footer">
  <p class="site-info">
    Proudly powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and
    Theme by <a href="https://github.com/CodeDaraW/Hacker" target="_blank">Hacker</a>
    </br>
    
    &copy; 2022 acwong
    
  </p>
</footer>
    
    
  </div>
</div>
</body>
</html>